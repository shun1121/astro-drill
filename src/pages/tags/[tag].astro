---
export async function getStaticPaths() {
  const allPosts = await Astro.glob('../blog/*.md')
  // 配列を動的に作り出す。new Set()
  const uniqueTags = [...new Set(allPosts.map((post) => post.frontmatter.title).flat())]
  return uniqueTags.map((tag) => {
    const filteredPosts = allPosts.filter((post) => post.frontmatter.title.includes(tag))
    return {
      params: { tag },
      // ↓getStaticPaths関数の外にfilteredPostsの内容を出して使いたいため
      props: { posts: filteredPosts }
    }
  })
}

const { tag } = Astro.params
const filteredPosts = Astro.props.posts
---

<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>タグ：{tag}のブログ一覧</title>
</head>
<body>
	<h1>ナビゲーション</h1>
  <ul>
    {filteredPosts.map((post) => (
      <li><a href={post.url}>{post.frontmatter.title}</a></li>
    ))}
  </ul>
</body>
</html>
